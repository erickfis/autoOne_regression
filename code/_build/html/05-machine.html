<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>Modeling with machine learning</title>
    
      <link rel="stylesheet" href="_static/pygments.css">
      <link rel="stylesheet" href="_static/theme.css">
      <link rel="stylesheet" href="_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>

      
      <script src="_static/theme-vendors.js"></script>
      <script src="_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <link rel="next" title="Python scripts" href="06-scripts.html" />
  <link rel="prev" title="Linear regression - sklearn" href="04-sklearn-linear.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="index.html" class="home-link">
    
      <span class="site-name">AutoOne Regression</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#autoone-price-prediction">Contents:</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="01-cleaning.html" class="reference internal ">Data cleaning</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="02-analysis.html" class="reference internal ">Exploratory data analysis - features - TO DO</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="02-analysis-price.html" class="reference internal ">Exploratory data analysis - price</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="03-ols.html" class="reference internal ">Linear regression - OLS Model</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="04-sklearn-linear.html" class="reference internal ">Linear regression - sklearn</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Modeling with machine learning</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#Hyper-parameter-tuning-and-Cross-Validation" class="reference internal">Hyper-parameter tuning and Cross Validation</a></li>
                
                  <li class="toctree-l2"><a href="#Decision-Tree-Regressor" class="reference internal">Decision Tree Regressor</a></li>
                
                  <li class="toctree-l2"><a href="#k-Nearest-Neighbors" class="reference internal">k-Nearest Neighbors</a></li>
                
                  <li class="toctree-l2"><a href="#Random-Forests" class="reference internal">Random Forests</a></li>
                
                  <li class="toctree-l2"><a href="#Gradient-tree-boosting" class="reference internal">Gradient tree boosting</a></li>
                
                  <li class="toctree-l2"><a href="#AdaBoost" class="reference internal">AdaBoost</a></li>
                
                  <li class="toctree-l2"><a href="#Comparing-models---MSE-and-R^2" class="reference internal">Comparing models - MSE and R^2</a></li>
                
                  <li class="toctree-l2"><a href="#Conclusions" class="reference internal">Conclusions</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="06-scripts.html" class="reference internal ">Python scripts</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="07-about.html" class="reference internal ">About me</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
    <li>Modeling with machine learning</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="04-sklearn-linear.html"
       title="previous chapter">← Linear regression - sklearn</a>
  </li>
  <li class="next">
    <a href="06-scripts.html"
       title="next chapter">Python scripts →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Modeling-with-machine-learning">
<h1>Modeling with machine learning<a class="headerlink" href="#Modeling-with-machine-learning" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will cover:</p>
<ul class="simple">
<li><p>fitting different machine learting regression models with sklearn</p></li>
<li><p>score analysis: MSE and variance explained: <span class="math notranslate nohighlight">\(R^2\)</span></p></li>
<li><p>comparing the models: conclusions</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/df_resample.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>make</th>
      <th>fuel_type</th>
      <th>aspiration</th>
      <th>num_of_doors</th>
      <th>body_style</th>
      <th>drive_wheels</th>
      <th>engine_location</th>
      <th>wheel_base</th>
      <th>length</th>
      <th>...</th>
      <th>engine_size</th>
      <th>fuel_system</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression_ratio</th>
      <th>horsepower</th>
      <th>peak_rpm</th>
      <th>city_mpg</th>
      <th>highway_mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>nissan</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>97.2</td>
      <td>173.4</td>
      <td>...</td>
      <td>120</td>
      <td>2bbl</td>
      <td>3.33</td>
      <td>3.47</td>
      <td>8.5</td>
      <td>97.0</td>
      <td>5200.0</td>
      <td>27</td>
      <td>34</td>
      <td>9549.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>volkswagen</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>165.7</td>
      <td>...</td>
      <td>109</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.5</td>
      <td>90.0</td>
      <td>5500.0</td>
      <td>24</td>
      <td>29</td>
      <td>9980.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>bmw</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>103.5</td>
      <td>189.0</td>
      <td>...</td>
      <td>164</td>
      <td>mpfi</td>
      <td>3.31</td>
      <td>3.19</td>
      <td>9.0</td>
      <td>121.0</td>
      <td>4250.0</td>
      <td>20</td>
      <td>25</td>
      <td>24565.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>subaru</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>93.7</td>
      <td>156.9</td>
      <td>...</td>
      <td>97</td>
      <td>2bbl</td>
      <td>3.62</td>
      <td>2.36</td>
      <td>9.0</td>
      <td>69.0</td>
      <td>4900.0</td>
      <td>31</td>
      <td>36</td>
      <td>5118.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>mazda</td>
      <td>diesel</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.9</td>
      <td>175.0</td>
      <td>...</td>
      <td>134</td>
      <td>idi</td>
      <td>3.43</td>
      <td>3.64</td>
      <td>22.0</td>
      <td>72.0</td>
      <td>4200.0</td>
      <td>31</td>
      <td>39</td>
      <td>18344.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">price</span><span class="p">)</span> <span class="c1"># as discussed, we are going to use the log transform here</span>

<span class="c1">## Train-test split#</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">95276</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># normalize and encode</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/category_list&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">cat_cols</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="c1"># numeric columns</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">]</span>

<span class="c1"># normalize numeric features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">num_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="c1"># encode categories</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cat_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">])</span>

<span class="c1"># all together</span>
<span class="n">X_train_proc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat_encoded</span><span class="p">,</span> <span class="n">num_scaled</span><span class="p">]</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># apply transformations on test set</span>
<span class="n">num_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="c1"># encode categories</span>
<span class="n">cat_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">])</span>

<span class="c1"># all together</span>
<span class="n">X_test_proc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat_encoded</span><span class="p">,</span> <span class="n">num_scaled</span><span class="p">]</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_proc</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3000, 73)
</pre></div></div>
</div>
<div class="section" id="Hyper-parameter-tuning-and-Cross-Validation">
<h2>Hyper-parameter tuning and Cross Validation<a class="headerlink" href="#Hyper-parameter-tuning-and-Cross-Validation" title="Permalink to this headline">¶</a></h2>
<p>It is important to note that we are going to use the gridsearchCV method, so we can iterate over a series of hyper-parameters for each model in order to find the best combination of them through cross validation.</p>
</div>
<div class="section" id="Decision-Tree-Regressor">
<h2>Decision Tree Regressor<a class="headerlink" href="#Decision-Tree-Regressor" title="Permalink to this headline">¶</a></h2>
<p>Lets start trying a simple sklearn decision tree regression model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">aux_functions</span> <span class="k">as</span> <span class="nn">aux</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">95276</span><span class="p">)</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Decision tree&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train_proc</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_proc</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">dt_results</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">make_regressor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Decision tree
Score r2: 0.9985
Score MSE: 7.789e+04
Time: 1.8e+01s
{&#39;ccp_alpha&#39;: 0.0, &#39;criterion&#39;: &#39;mse&#39;, &#39;max_depth&#39;: 20, &#39;max_features&#39;: None, &#39;max_leaf_nodes&#39;: None, &#39;min_impurity_decrease&#39;: 0.0, &#39;min_impurity_split&#39;: None, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;min_weight_fraction_leaf&#39;: 0.0, &#39;presort&#39;: &#39;deprecated&#39;, &#39;random_state&#39;: 95276, &#39;splitter&#39;: &#39;best&#39;}
</pre></div></div>
</div>
</div>
<div class="section" id="k-Nearest-Neighbors">
<h2>k-Nearest Neighbors<a class="headerlink" href="#k-Nearest-Neighbors" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="p">}</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;knn&#39;</span>
<span class="n">knn_results</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">make_regressor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
knn
Score r2: 0.9985
Score MSE: 8.469e+04
Time: 1.3s
{&#39;algorithm&#39;: &#39;auto&#39;, &#39;leaf_size&#39;: 30, &#39;metric&#39;: &#39;minkowski&#39;, &#39;metric_params&#39;: None, &#39;n_jobs&#39;: None, &#39;n_neighbors&#39;: 10, &#39;p&#39;: 1, &#39;weights&#39;: &#39;uniform&#39;}
</pre></div></div>
</div>
</div>
<div class="section" id="Random-Forests">
<h2>Random Forests<a class="headerlink" href="#Random-Forests" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RF&#39;</span>
<span class="n">rf_results</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">make_regressor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RF
Score r2: 0.9985
Score MSE: 7.798e+04
Time: 1.5e+01s
{&#39;bootstrap&#39;: True, &#39;ccp_alpha&#39;: 0.0, &#39;criterion&#39;: &#39;mse&#39;, &#39;max_depth&#39;: 30, &#39;max_features&#39;: 10, &#39;max_leaf_nodes&#39;: None, &#39;max_samples&#39;: None, &#39;min_impurity_decrease&#39;: 0.0, &#39;min_impurity_split&#39;: None, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;min_weight_fraction_leaf&#39;: 0.0, &#39;n_estimators&#39;: 100, &#39;n_jobs&#39;: None, &#39;oob_score&#39;: False, &#39;random_state&#39;: None, &#39;verbose&#39;: 0, &#39;warm_start&#39;: False}
</pre></div></div>
</div>
</div>
<div class="section" id="Gradient-tree-boosting">
<h2>Gradient tree boosting<a class="headerlink" href="#Gradient-tree-boosting" title="Permalink to this headline">¶</a></h2>
<p>The gradient tree boosting is an ensemble machine learning methods too, but this time we have the boosting class: several weak models are combined to produce a powerful estimator with reduced bias.</p>
<p>This method is very robust because it uses regularization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">()</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Gradient Boost&#39;</span>
<span class="n">gb_results</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">make_regressor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gradient Boost
Score r2: 0.9883
Score MSE: 5.876e+05
Time: 3.6s
{&#39;alpha&#39;: 0.9, &#39;ccp_alpha&#39;: 0.0, &#39;criterion&#39;: &#39;friedman_mse&#39;, &#39;init&#39;: None, &#39;learning_rate&#39;: 0.1, &#39;loss&#39;: &#39;ls&#39;, &#39;max_depth&#39;: 3, &#39;max_features&#39;: None, &#39;max_leaf_nodes&#39;: None, &#39;min_impurity_decrease&#39;: 0.0, &#39;min_impurity_split&#39;: None, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 5, &#39;min_weight_fraction_leaf&#39;: 0.0, &#39;n_estimators&#39;: 100, &#39;n_iter_no_change&#39;: None, &#39;presort&#39;: &#39;deprecated&#39;, &#39;random_state&#39;: None, &#39;subsample&#39;: 1.0, &#39;tol&#39;: 0.0001, &#39;validation_fraction&#39;: 0.1, &#39;verbose&#39;: 0, &#39;warm_start&#39;: False}
</pre></div></div>
</div>
</div>
<div class="section" id="AdaBoost">
<h2>AdaBoost<a class="headerlink" href="#AdaBoost" title="Permalink to this headline">¶</a></h2>
<p>Adaboost is another ensemble machine learning method of the boosting class.</p>
<p>This time, however, we can start with the best model we have so far. Then, copies of the original model will be fitted on the same dataset, but weights will be attributed to them according to the error of the prediction.</p>
<p>Lets use our previously trained decision tree regressor.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostRegressor</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AdaBoostRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">95276</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">dt_results</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;AdaBoost&#39;</span>
<span class="n">ada_results</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">make_regressor</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">grid_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AdaBoost
Score r2: 0.9985
Score MSE: 7.865e+04
Time: 1.2s
{&#39;base_estimator__ccp_alpha&#39;: 0.0, &#39;base_estimator__criterion&#39;: &#39;mse&#39;, &#39;base_estimator__max_depth&#39;: 20, &#39;base_estimator__max_features&#39;: None, &#39;base_estimator__max_leaf_nodes&#39;: None, &#39;base_estimator__min_impurity_decrease&#39;: 0.0, &#39;base_estimator__min_impurity_split&#39;: None, &#39;base_estimator__min_samples_leaf&#39;: 2, &#39;base_estimator__min_samples_split&#39;: 2, &#39;base_estimator__min_weight_fraction_leaf&#39;: 0.0, &#39;base_estimator__presort&#39;: &#39;deprecated&#39;, &#39;base_estimator__random_state&#39;: 95276, &#39;base_estimator__splitter&#39;: &#39;best&#39;, &#39;base_estimator&#39;: DecisionTreeRegressor(ccp_alpha=0.0, criterion=&#39;mse&#39;, max_depth=20,
                      max_features=None, max_leaf_nodes=None,
                      min_impurity_decrease=0.0, min_impurity_split=None,
                      min_samples_leaf=2, min_samples_split=2,
                      min_weight_fraction_leaf=0.0, presort=&#39;deprecated&#39;,
                      random_state=95276, splitter=&#39;best&#39;), &#39;learning_rate&#39;: 0.5, &#39;loss&#39;: &#39;linear&#39;, &#39;n_estimators&#39;: 50, &#39;random_state&#39;: 95276}
</pre></div></div>
</div>
</div>
<div class="section" id="Comparing-models---MSE-and-R^2">
<h2>Comparing models - MSE and <span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#Comparing-models---MSE-and-R^2" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">dt_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;mse&#39;</span><span class="p">],</span>
        <span class="n">knn_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;mse&#39;</span><span class="p">],</span>
        <span class="n">rf_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;mse&#39;</span><span class="p">],</span>
        <span class="n">gb_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;mse&#39;</span><span class="p">],</span>
        <span class="n">ada_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;mse&#39;</span><span class="p">]</span>

        <span class="p">],</span>
    <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">dt_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span>
        <span class="n">knn_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span>
        <span class="n">rf_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span>
        <span class="n">gb_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span>
        <span class="n">ada_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span>
        <span class="p">],</span>
    <span class="s1">&#39;model name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">dt_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;model name&#39;</span><span class="p">],</span>
        <span class="n">knn_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;model name&#39;</span><span class="p">],</span>
        <span class="n">rf_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;model name&#39;</span><span class="p">],</span>
        <span class="n">gb_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;model name&#39;</span><span class="p">],</span>
        <span class="n">ada_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;model name&#39;</span><span class="p">]</span>
        <span class="p">],</span>
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">dt_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">knn_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">rf_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">gb_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">ada_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="c1">#     index=[&#39;linear&#39;, &#39;ridge&#39;, &#39;lasso&#39;, &#39;hubber&#39;]</span>
<span class="p">)</span>

<span class="c1"># load ols results</span>
<span class="n">df_scores_old</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/sk_scores.csv&#39;</span><span class="p">)</span>
<span class="n">df_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_scores</span><span class="p">,</span> <span class="n">df_scores_old</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># lets get the rmse</span>
<span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">])</span>

<span class="c1"># now lets measure the impact of processing time over RMSE</span>
<span class="n">df_scores</span> <span class="o">=</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;dif_rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;dif_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_scores</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/full_scores.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_scores</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;model name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSE</th>
      <th>r2</th>
      <th>time</th>
      <th>rmse</th>
      <th>dif_rmse</th>
      <th>dif_time</th>
    </tr>
    <tr>
      <th>model name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lasso Regression</th>
      <td>2636548.565</td>
      <td>0.960</td>
      <td>0.487</td>
      <td>1623.745</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ols</th>
      <td>2175057.358</td>
      <td>0.969</td>
      <td>0.792</td>
      <td>1474.808</td>
      <td>-148.938</td>
      <td>0.305</td>
    </tr>
    <tr>
      <th>Ridge Regression</th>
      <td>2123265.316</td>
      <td>0.971</td>
      <td>4.063</td>
      <td>1457.143</td>
      <td>-17.665</td>
      <td>3.271</td>
    </tr>
    <tr>
      <th>HUbber Regression</th>
      <td>2123061.444</td>
      <td>0.971</td>
      <td>63.894</td>
      <td>1457.073</td>
      <td>-0.070</td>
      <td>59.831</td>
    </tr>
    <tr>
      <th>Linear Regression</th>
      <td>2122211.274</td>
      <td>0.971</td>
      <td>14.993</td>
      <td>1456.781</td>
      <td>-0.292</td>
      <td>-48.901</td>
    </tr>
    <tr>
      <th>Gradient Boost</th>
      <td>587570.524</td>
      <td>0.988</td>
      <td>3.617</td>
      <td>766.531</td>
      <td>-690.250</td>
      <td>-11.376</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>84686.639</td>
      <td>0.998</td>
      <td>1.337</td>
      <td>291.010</td>
      <td>-475.522</td>
      <td>-2.279</td>
    </tr>
    <tr>
      <th>AdaBoost</th>
      <td>78647.131</td>
      <td>0.999</td>
      <td>1.189</td>
      <td>280.441</td>
      <td>-10.569</td>
      <td>-0.148</td>
    </tr>
    <tr>
      <th>RF</th>
      <td>77984.792</td>
      <td>0.999</td>
      <td>15.136</td>
      <td>279.258</td>
      <td>-1.183</td>
      <td>13.947</td>
    </tr>
    <tr>
      <th>Decision tree</th>
      <td>77889.082</td>
      <td>0.999</td>
      <td>17.938</td>
      <td>279.086</td>
      <td>-0.171</td>
      <td>2.803</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Conclusions">
<h2>Conclusions<a class="headerlink" href="#Conclusions" title="Permalink to this headline">¶</a></h2>
<p>Considering the computation time and the error measured on the test set, we can conclude that:</p>
<ul class="simple">
<li><p>OLS is not a good choice here unless we add the non-linear contributions of each feature to the explain the outcome.</p></li>
<li><p>Given that all sklearn linear models have almost the same scores, Ridge Regression would be chosen due to the time it needs to be trained while automatically adjusting the weights of each feature, so we don’t need to manually select them</p></li>
<li><p>among the ML models, its important to note that the KNN model took 10x less time to produce a model almost as good as the alternatives.</p></li>
<li><p>ML have 5x improved performance (RMSE) over Linear Models because it doesn’t rely on the linear correlations between predictors and the outcome. The linear models could have better performance if we added the contributions of interdependent terms or non-linear transformations of them.</p></li>
</ul>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="04-sklearn-linear.html"
       title="previous chapter">← Linear regression - sklearn</a>
  </li>
  <li class="next">
    <a href="06-scripts.html"
       title="next chapter">Python scripts →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, Erick Medeiros Anastácio.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.0 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>