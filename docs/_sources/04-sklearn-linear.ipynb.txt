{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Linear regression - sklearn\n",
    "\n",
    "In this section, we will cover:\n",
    "\n",
    "- fitting different linear regression models with sklearn\n",
    "- normalization and encoding of features\n",
    "- score analysis: MSE and variance explained: $R^2$\n",
    "- residual analysis\n",
    "- most important features\n",
    "- comparing the models: conclusions\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symboling</th>\n",
       "      <th>make</th>\n",
       "      <th>fuel_type</th>\n",
       "      <th>aspiration</th>\n",
       "      <th>num_of_doors</th>\n",
       "      <th>body_style</th>\n",
       "      <th>drive_wheels</th>\n",
       "      <th>engine_location</th>\n",
       "      <th>wheel_base</th>\n",
       "      <th>length</th>\n",
       "      <th>...</th>\n",
       "      <th>engine_size</th>\n",
       "      <th>fuel_system</th>\n",
       "      <th>bore</th>\n",
       "      <th>stroke</th>\n",
       "      <th>compression_ratio</th>\n",
       "      <th>horsepower</th>\n",
       "      <th>peak_rpm</th>\n",
       "      <th>city_mpg</th>\n",
       "      <th>highway_mpg</th>\n",
       "      <th>price</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>mitsubishi</td>\n",
       "      <td>gas</td>\n",
       "      <td>std</td>\n",
       "      <td>two</td>\n",
       "      <td>hatchback</td>\n",
       "      <td>fwd</td>\n",
       "      <td>front</td>\n",
       "      <td>93.7</td>\n",
       "      <td>157.3</td>\n",
       "      <td>...</td>\n",
       "      <td>92</td>\n",
       "      <td>2bbl</td>\n",
       "      <td>2.97</td>\n",
       "      <td>3.23</td>\n",
       "      <td>9.4</td>\n",
       "      <td>68.0</td>\n",
       "      <td>5500.0</td>\n",
       "      <td>37</td>\n",
       "      <td>41</td>\n",
       "      <td>5389.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>dodge</td>\n",
       "      <td>gas</td>\n",
       "      <td>std</td>\n",
       "      <td>four</td>\n",
       "      <td>sedan</td>\n",
       "      <td>fwd</td>\n",
       "      <td>front</td>\n",
       "      <td>93.7</td>\n",
       "      <td>157.3</td>\n",
       "      <td>...</td>\n",
       "      <td>90</td>\n",
       "      <td>2bbl</td>\n",
       "      <td>2.97</td>\n",
       "      <td>3.23</td>\n",
       "      <td>9.4</td>\n",
       "      <td>68.0</td>\n",
       "      <td>5500.0</td>\n",
       "      <td>31</td>\n",
       "      <td>38</td>\n",
       "      <td>6692.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>jaguar</td>\n",
       "      <td>gas</td>\n",
       "      <td>std</td>\n",
       "      <td>two</td>\n",
       "      <td>sedan</td>\n",
       "      <td>rwd</td>\n",
       "      <td>front</td>\n",
       "      <td>102.0</td>\n",
       "      <td>191.7</td>\n",
       "      <td>...</td>\n",
       "      <td>326</td>\n",
       "      <td>mpfi</td>\n",
       "      <td>3.54</td>\n",
       "      <td>2.76</td>\n",
       "      <td>11.5</td>\n",
       "      <td>262.0</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>13</td>\n",
       "      <td>17</td>\n",
       "      <td>36000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>peugot</td>\n",
       "      <td>gas</td>\n",
       "      <td>std</td>\n",
       "      <td>four</td>\n",
       "      <td>sedan</td>\n",
       "      <td>rwd</td>\n",
       "      <td>front</td>\n",
       "      <td>107.9</td>\n",
       "      <td>186.7</td>\n",
       "      <td>...</td>\n",
       "      <td>120</td>\n",
       "      <td>mpfi</td>\n",
       "      <td>3.46</td>\n",
       "      <td>3.19</td>\n",
       "      <td>8.4</td>\n",
       "      <td>97.0</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>19</td>\n",
       "      <td>24</td>\n",
       "      <td>11900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>subaru</td>\n",
       "      <td>gas</td>\n",
       "      <td>turbo</td>\n",
       "      <td>four</td>\n",
       "      <td>sedan</td>\n",
       "      <td>fwd</td>\n",
       "      <td>front</td>\n",
       "      <td>97.0</td>\n",
       "      <td>172.0</td>\n",
       "      <td>...</td>\n",
       "      <td>108</td>\n",
       "      <td>mpfi</td>\n",
       "      <td>3.62</td>\n",
       "      <td>2.64</td>\n",
       "      <td>7.7</td>\n",
       "      <td>111.0</td>\n",
       "      <td>4800.0</td>\n",
       "      <td>24</td>\n",
       "      <td>29</td>\n",
       "      <td>11259.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   symboling        make fuel_type aspiration num_of_doors body_style  \\\n",
       "0          2  mitsubishi       gas        std          two  hatchback   \n",
       "1          1       dodge       gas        std         four      sedan   \n",
       "2          0      jaguar       gas        std          two      sedan   \n",
       "3          0      peugot       gas        std         four      sedan   \n",
       "4          0      subaru       gas      turbo         four      sedan   \n",
       "\n",
       "  drive_wheels engine_location  wheel_base  length  ...  engine_size  \\\n",
       "0          fwd           front        93.7   157.3  ...           92   \n",
       "1          fwd           front        93.7   157.3  ...           90   \n",
       "2          rwd           front       102.0   191.7  ...          326   \n",
       "3          rwd           front       107.9   186.7  ...          120   \n",
       "4          fwd           front        97.0   172.0  ...          108   \n",
       "\n",
       "   fuel_system  bore stroke compression_ratio  horsepower peak_rpm  city_mpg  \\\n",
       "0         2bbl  2.97   3.23               9.4        68.0   5500.0        37   \n",
       "1         2bbl  2.97   3.23               9.4        68.0   5500.0        31   \n",
       "2         mpfi  3.54   2.76              11.5       262.0   5000.0        13   \n",
       "3         mpfi  3.46   3.19               8.4        97.0   5000.0        19   \n",
       "4         mpfi  3.62   2.64               7.7       111.0   4800.0        24   \n",
       "\n",
       "   highway_mpg    price  \n",
       "0           41   5389.0  \n",
       "1           38   6692.0  \n",
       "2           17  36000.0  \n",
       "3           24  11900.0  \n",
       "4           29  11259.0  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "df = pd.read_csv('data/df_resample.csv')\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df.copy()\n",
    "X.drop('price', axis=1, inplace=True)\n",
    "y = np.log(df.price) # as discussed, we are going to use the log transform here\n",
    "\n",
    "## Train-test split#\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X, y, test_size=.3, random_state=95276\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "## Normalization and encoding of features\n",
    "\n",
    "The range of the numeric features varies a lot for each one of them:\n",
    "\n",
    "- bore range: ~2\n",
    "- curb range: ~3500\n",
    "\n",
    "Also, its easy to see that they are measuring completely different things and therefore are in different scales.\n",
    "\n",
    "In order to properly fit linear regression models with regularization, we must account for those differences.\n",
    "\n",
    "Also, it is import to encode the categories, like fuel-type, to sklearn can use them."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(7000, 73)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.preprocessing import OneHotEncoder, StandardScaler\n",
    "import pickle\n",
    "\n",
    "with open('data/category_list', 'rb') as file:\n",
    "    cat_cols = pickle.load(file)\n",
    "\n",
    "# numeric columns\n",
    "num_cols = [col for col in X_train.columns if col not in cat_cols]\n",
    "\n",
    "# normalize numeric features\n",
    "scaler = StandardScaler()\n",
    "num_scaled = scaler.fit_transform(X_train[num_cols])\n",
    "\n",
    "# encode categories\n",
    "encoder = OneHotEncoder(sparse=False)\n",
    "cat_encoded = encoder.fit_transform(X_train[cat_cols])\n",
    "\n",
    "# all together\n",
    "X_train_proc = np.concatenate([cat_encoded, num_scaled] ,axis=1)\n",
    "X_train_proc.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3000, 73)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# apply transformations on test set\n",
    "num_scaled = scaler.transform(X_test[num_cols])\n",
    "\n",
    "# encode categories\n",
    "cat_encoded = encoder.transform(X_test[cat_cols])\n",
    "\n",
    "# all together\n",
    "X_test_proc = np.concatenate([cat_encoded, num_scaled] ,axis=1)\n",
    "X_test_proc.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Hyper-parameter tuning and Cross Validation\n",
    "\n",
    "It is important to note that we are going to use the gridsearchCV method, so we can iterate over a series of hyper-parameters for each model in order to find the best combination of them through cross validation.\n",
    "\n",
    "## Linear regression model\n",
    "\n",
    "Lets start trying a simple sklearn linear regression model, without regularization.\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2\n",
    "\n",
    "import aux_functions as aux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Linear Regression\n",
      "Score r2: 0.9714 \n",
      "Score MSE: 1.157e+06 \n",
      "Time: 1.3e+01s\n",
      "{'copy_X': True, 'fit_intercept': True, 'n_jobs': None, 'normalize': False}\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "\n",
    "model = LinearRegression()\n",
    "grid_params = {'fit_intercept': [True, False]}\n",
    "name = 'Linear Regression'\n",
    "data = (X_train_proc, y_train, X_test_proc, y_test)\n",
    "\n",
    "linear_results = aux.make_regressor(name, model, grid_params, data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Regularized models - Ridge regularization\n",
    "\n",
    "Ridge regression uses a penalty L2 factor for the least important regressors. \n",
    "\n",
    "- L2: least squared deviation $resid = \\sum{(y_i - \\hat y_i)^2} + \\lambda \\sum{\\beta^2}$\n",
    "\n",
    "However, the least squares regularization is not robust: it is sensitive to outliers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ridge Regression\n",
      "Score r2: 0.9714 \n",
      "Score MSE: 1.157e+06 \n",
      "Time: 3.8s\n",
      "{'alpha': 0.1, 'copy_X': True, 'fit_intercept': True, 'max_iter': None, 'normalize': False, 'random_state': None, 'solver': 'auto', 'tol': 0.001}\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import Ridge\n",
    "\n",
    "model = Ridge()\n",
    "grid_params = {'alpha': [.001, .01, .1, 1]}\n",
    "name = 'Ridge Regression'\n",
    "ridge_results = aux.make_regressor(name, model, grid_params, data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Regularized models - Lasso\n",
    "\n",
    "Lasso regression uses a stronger penalty for the least important regressors, the L1.\n",
    "\n",
    "That said, lasso will perform feature selection and it is not a stable solution.\n",
    "\n",
    "- L1: least absolute deviation: $resid = \\sum{(y_i - \\hat y_i)^2} + \\lambda \\sum{|\\beta|}$\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Lasso Regression\n",
      "Score r2: 0.962 \n",
      "Score MSE: 1.618e+06 \n",
      "Time: 0.47s\n",
      "{'alpha': 0.001, 'copy_X': True, 'fit_intercept': True, 'max_iter': 1000, 'normalize': False, 'positive': False, 'precompute': False, 'random_state': None, 'selection': 'cyclic', 'tol': 0.0001, 'warm_start': False}\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import Lasso\n",
    "\n",
    "model = Lasso()\n",
    "grid_params = {'alpha': [.001, .01, .1, 1]}\n",
    "name = 'Lasso Regression'\n",
    "lasso_results = aux.make_regressor(name, model, grid_params, data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Huber Regressor\n",
    "\n",
    "Huber uses L2 and L1 penalty. This makes it specially strong against outliers:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "HUbber Regression\n",
      "Score r2: 0.9714 \n",
      "Score MSE: 1.157e+06 \n",
      "Time: 7e+01s\n",
      "{'alpha': 0.1, 'epsilon': 5, 'fit_intercept': True, 'max_iter': 1000, 'tol': 1e-05, 'warm_start': False}\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import HuberRegressor\n",
    "\n",
    "model = HuberRegressor(max_iter=1000)\n",
    "grid_params = {\n",
    "    'alpha': [.001, .01, .1],\n",
    "    'epsilon': [1, 5, 10]\n",
    "}\n",
    "name = 'HUbber Regression'\n",
    "hubber_results = aux.make_regressor(name, model, grid_params, data)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Comparing models - MSE and $R^2$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MSE</th>\n",
       "      <th>r2</th>\n",
       "      <th>model name</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.156840e+06</td>\n",
       "      <td>0.9714</td>\n",
       "      <td>Linear Regression</td>\n",
       "      <td>13.1890</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.156863e+06</td>\n",
       "      <td>0.9714</td>\n",
       "      <td>HUbber Regression</td>\n",
       "      <td>69.7017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.157179e+06</td>\n",
       "      <td>0.9714</td>\n",
       "      <td>Ridge Regression</td>\n",
       "      <td>3.7854</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.211086e+06</td>\n",
       "      <td>0.9690</td>\n",
       "      <td>ols</td>\n",
       "      <td>0.7020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.618442e+06</td>\n",
       "      <td>0.9620</td>\n",
       "      <td>Lasso Regression</td>\n",
       "      <td>0.4744</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            MSE      r2         model name     time\n",
       "0  1.156840e+06  0.9714  Linear Regression  13.1890\n",
       "3  1.156863e+06  0.9714  HUbber Regression  69.7017\n",
       "1  1.157179e+06  0.9714   Ridge Regression   3.7854\n",
       "0  1.211086e+06  0.9690                ols   0.7020\n",
       "2  1.618442e+06  0.9620   Lasso Regression   0.4744"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_scores = pd.DataFrame({\n",
    "    'MSE': [\n",
    "        linear_results[2]['mse'],\n",
    "        ridge_results[2]['mse'],\n",
    "        lasso_results[2]['mse'],\n",
    "        hubber_results[2]['mse'],\n",
    "\n",
    "        ],\n",
    "    'r2': [\n",
    "        linear_results[2]['r2'],\n",
    "        ridge_results[2]['r2'],\n",
    "        lasso_results[2]['r2'],\n",
    "        hubber_results[2]['r2'],\n",
    "        ],\n",
    "    'model name': [\n",
    "        linear_results[2]['model name'],\n",
    "        ridge_results[2]['model name'],\n",
    "        lasso_results[2]['model name'],\n",
    "        hubber_results[2]['model name'],\n",
    "        ],\n",
    "    'time': [\n",
    "        linear_results[2]['time'],\n",
    "        ridge_results[2]['time'],\n",
    "        lasso_results[2]['time'],\n",
    "        hubber_results[2]['time'],\n",
    "        ],\n",
    "    },\n",
    "#     index=['linear', 'ridge', 'lasso', 'hubber']\n",
    ")\n",
    "\n",
    "# load ols results\n",
    "df_scores_ols = pd.read_csv('data/scores.csv')\n",
    "df_scores = pd.concat([df_scores, df_scores_ols], axis=0)\n",
    "df_scores.to_csv('data/sk_scores.csv', index=False)\n",
    "df_scores.sort_values(by='MSE').round(4)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Most important features\n",
    "\n",
    "Lets check what are the most important features, aside from make:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "model = ridge_results[0]\n",
    "\n",
    "cat_list = []\n",
    "# make is the categories_[0]\n",
    "for item in encoder.categories_[1:]:\n",
    "    for cat in item:\n",
    "        cat_list.append(cat)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x22f41760108>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAwEAAAE+CAYAAADVrBxEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3de7xddX3n/9ebBAgFRMHUQUJMQC5iuSdxhIJQJVBRsD+D4JU4Ogy14Ez702kcO+jg2KL4EzuKFawUfxQKgtXJCC03uUS5JUC4hGvAVNL4sAiKyE0Cn/ljrYSdw0nOPslJTpL1ej4e53HW/q7L/q7vXnvv9V7ru9ZOVSFJkiSpOzYZ7QpIkiRJWrcMAZIkSVLHGAIkSZKkjjEESJIkSR1jCJAkSZI6xhAgSZIkdczY0a7AQK9+9atr0qRJo10NSZIkaYN26623/qKqxg82br0LAZMmTWLevHmjXQ1JkiRpg5bkX1Y2zu5AkiRJUscYAiRJkqSO6SsEJDkiyf1JFiaZNcj4E5PclWR+kh8l2aNn3Kfa+e5PcvhIVl6SJEnS8A15TUCSMcCZwGHAYmBuktlVdU/PZBdU1Tfa6Y8Cvgwc0YaB44A3Aq8Frkqya1W9MMLrIUmSpPXE888/z+LFi3n22WdHuyqdMG7cOCZMmMCmm27a9zz9XBg8DVhYVQ8DJLkQOBpYHgKq6tc9028JVDt8NHBhVT0H/CTJwnZ5N/ZdQ0mSJG1QFi9ezNZbb82kSZNIMtrV2ahVFY899hiLFy9m8uTJfc/XT3egHYBHeh4vbstWkORPkjwEfBH4+HDmlSRJ0sbj2WefZbvttjMArANJ2G677YZ91qWfEDDYq1cvK6g6s6p2Bv4c+IvhzJvkhCTzksx79NFH+6iSJEmS1mcGgHVnddq6nxCwGNix5/EEYMkqpr8QeNdw5q2qs6tqSlVNGT9+0N8zkCRJkvp2wAEHrNPnW7RoERdccME6fc410c81AXOBXZJMBv6V5kLf9/VOkGSXqnqwfXgksGx4NnBBki/TXBi8C3DLSFRckiRJG4ZJsy4d0eUtOu3IIae54YYbRvQ5V2Xp0qXLQ8D73ve+oWdYDwx5JqCqlgInAZcD9wLfqaoFSU5t7wQEcFKSBUnmA38GHN/OuwD4Ds1FxP8M/Il3BpIkSdLattVWWwFw7bXX8pa3vIX3vOc97LrrrsyaNYvzzz+fadOmseeee/LQQw8BMHPmTE488UQOOuggdt11V37wgx8AzfUNH/7wh9lzzz3Zd999ueaaawA499xzOeaYY3jnO9/J9OnTmTVrFnPmzGGfffbhjDPOYNGiRRx00EHst99+7LfffstDybXXXsshhxzCjBkz2H333Xn/+99PVdNbfu7cuRxwwAHsvffeTJs2jSeffJIXXniBT37yk0ydOpW99tqLs846a0Tap58zAVTVZcBlA8pO6Rn+z6uY9/PA51e3gpIkSdKauOOOO7j33nvZdttt2WmnnfjoRz/KLbfcwl//9V/z1a9+la985StA06Xnuuuu46GHHuLQQw9l4cKFnHnmmQDcdddd3HfffUyfPp0HHngAgBtvvJE777yTbbfdlmuvvZYvfelLy8PD008/zZVXXsm4ceN48MEHee9738u8efMAuP3221mwYAGvfe1rOfDAA/nxj3/MtGnTOPbYY7nooouYOnUqv/71r9liiy341re+xTbbbMPcuXN57rnnOPDAA5k+ffqw7gQ0mL5CwIZqpE89ral+Tl1JkiRpZE2dOpXtt98egJ133pnp06cDsOeeey4/sg/wnve8h0022YRddtmFnXbaifvuu48f/ehHnHzyyQDsvvvuvO51r1seAg477DC23XbbQZ/z+eef56STTmL+/PmMGTNm+TwA06ZNY8KECQDss88+LFq0iG222Ybtt9+eqVOnAvCKV7wCgCuuuII777yTSy65BIAnnniCBx980BAgSZIkrcrmm2++fHiTTTZZ/niTTTZh6dKly8cNvMtOkuVddQaz5ZZbrnTcGWecwWte8xruuOMOXnzxRcaNGzdofcaMGcPSpUupqkHv8lNVfPWrX+Xwww9fxRoOXz93B5IkSZI2ehdffDEvvvgiDz30EA8//DC77bYbBx98MOeffz4ADzzwAD/96U/ZbbfdXjbv1ltvzZNPPrn88RNPPMH222/PJptswnnnnccLL6z6stjdd9+dJUuWMHfuXACefPJJli5dyuGHH87f/M3f8Pzzzy+vw1NPPbXG6+qZAEmSJAnYbbfdeMtb3sLPf/5zvvGNbzBu3Dg+9rGPceKJJ7LnnnsyduxYzj333BWO5C+z1157MXbsWPbee29mzpzJxz72Md797ndz8cUXc+ihh67yrAHAZptt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\n",
      "text/plain": [
       "<Figure size 936x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "features = cat_list + num_cols\n",
    "coefs = model.coef_\n",
    "\n",
    "# coefs 0 to 21 are the make coefs\n",
    "df_features = pd.DataFrame({'feature': features, 'importance': coefs[21:]})\n",
    "(df_features.sort_values(by='importance', ascending=False)\n",
    "    .set_index('feature').head(10)\n",
    "    .plot(kind='bar', figsize=(13, 5), rot=0)\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Comparing the models - conclusions\n",
    "\n",
    "- MSE analysis shows better results for the Ridge model: smallest MSE\n",
    "- $R^2$ analysis shows a tie between Ridge, Hubber and Linear models"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
